<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="referrer" content="no-referrer"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Hexo Theme Redefine"><meta name="author" content="Lu"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://registry.npmmirror.com" crossorigin><link rel="canonical" href="https://lusy37.github.io/2024/05/21/jdbc/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey."><meta property="og:type" content="article"><meta property="og:title" content="JDBC"><meta property="og:url" content="https://lusy37.github.io/2024/05/21/JDBC/index.html"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://lusy37.github.io/images/redefine-og.webp"><meta property="article:published_time" content="2024-05-20T16:00:00.000Z"><meta property="article:modified_time" content="2025-03-11T04:44:58.063Z"><meta property="article:author" content="Lu"><meta property="article:tag" content="学习总结"><meta property="article:tag" content="Java"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lusy37.github.io/images/redefine-og.webp"><link rel="icon" type="image/png" href="/images/redefine-favicon.jpg" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.jpg"><meta name="theme-color" content="#A31F34"><link rel="shortcut icon" href="/images/redefine-favicon.jpg"><title>JDBC | Lusy</title><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/css/build/tailwind.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Geist/geist.css"><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/anime.min.js"></script><script id="hexo-configurations">window.config={hostname:"lusy37.github.io",root:"/",language:"en",path:"search.xml"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!1,link_icon:!0,delete_mask:!1,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!1,list:[]},code_block:{copy:!0,style:"mac",highlight_theme:{light:"github",dark:"vs2015"},font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:6,number:!1,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!0,pangu_js:!1,recommendation:{enable:!1,title:"推荐阅读",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#A31F34",secondary:null,default_mode:"light"},global:{fonts:{chinese:{enable:!1,family:null,url:null},english:{enable:!1,family:null,url:null},title:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!0},scroll_progress:{bar:!1,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:{enable:!0,custom_message:null},open_graph:{enable:!0,image:"/images/redefine-og.webp",description:"Hexo Theme Redefine, Redefine Your Hexo Journey."},google_analytics:{enable:!1,id:null}},home_banner:{enable:!0,style:"fixed",image:{light:"/images/wallhaven-wqery6-light.webp",dark:"/images/wallhaven-wqery6-dark.webp"},title:"等一场花开",subtitle:{text:["迷失的人迷失了，相遇的人再相遇。","迷った人は迷い、出会った人はまた出会う。"],hitokoto:{enable:!1,show_author:!1,api:"https://v1.hitokoto.cn"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!0,smart_backspace:!0},text_color:{light:"#fff",dark:"#d1d1b6"},text_style:{title_size:"2.8rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!1,style:"default",links:{github:null,instagram:null,zhihu:null,twitter:null,email:null},qrs:{weixin:null}}},plugins:{feed:{enable:!1},aplayer:{enable:!1,type:"fixed",audios:[{name:null,artist:null,url:null,cover:null,lrc:null}]},mermaid:{enable:!1,version:"11.4.1"}},version:"2.8.2",navbar:{auto_hide:!1,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},Essays:{path:"/essays",icon:"fa-regular fa-pen-to-square"},Think:{path:"/think",icon:"fa-regular fa-paper-plane"}},search:{enable:!0,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:"If its rainy, you won't see me.If its sunny ,you'll think of me.",show_on_mobile:!0,links:{Archives:{path:"/archives",icon:"fa-regular fa-archive"},Tags:{path:"/tags",icon:"fa-regular fa-tags"},Categories:{path:"/categories",icon:"fa-regular fa-folder"}}},article_date_format:"YYYY-MM-DD",excerpt_length:200,categories:{enable:!0,limit:3},tags:{enable:!0,limit:3}},footerStart:"2024/2/12 15:45:14"},window.lang_ago={second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days ago",week:"%s weeks ago",month:"%s months ago",year:"%s years ago"},window.data={masonry:!1}</script><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/brands.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/solid.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/regular.min.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="progress-bar-container"><span class="pjax-progress-bar"></span></div><style>:root{--preloader-background-color:#fff;--preloader-text-color:#000}@media (prefers-color-scheme:dark){:root{--preloader-background-color:#202124;--preloader-text-color:#fff}}@media (prefers-color-scheme:light){:root{--preloader-background-color:#fff;--preloader-text-color:#000}}@media (max-width:600px){.ml13{font-size:2.6rem!important}}.preloader{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:1100;transition:opacity .2s ease-in-out}.ml13{font-size:3.2rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:Chillax-Variable,sans-serif;text-align:center}.ml13 .word{display:inline-flex;flex-wrap:wrap;white-space:nowrap}.ml13 .letter{display:inline-block;line-height:1em}</style><div class="preloader"><h2 class="ml13">Lusy</h2><script>var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }</script></div><main class="page-container" id="swup"><div class="main-content-container flex flex-col justify-between min-h-dvh"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content transition-navbar"><div class="left"><a class="logo-title" href="/">Lusy</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> HOME</a></li><li class="navbar-item"><a href="/essays"><i class="fa-regular fa-pen-to-square fa-fw"></i> ESSAYS</a></li><li class="navbar-item"><a href="/think"><i class="fa-regular fa-paper-plane fa-fw"></i> THINK</a></li><li class="navbar-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>HOME </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/essays"><span>ESSAYS </span><i class="fa-regular fa-pen-to-square fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/think"><span>THINK </span><i class="fa-regular fa-paper-plane fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active" href="/archives"><span>Archives</span> <i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active" href="/tags"><span>Tags</span> <i class="fa-regular fa-tags fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active" href="/categories"><span>Categories</span> <i class="fa-regular fa-folder fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">8</div><div class="label text-third-text-color text-sm">Tags</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">5</div><div class="label text-third-text-color text-sm">Categories</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">23</div><div class="label text-third-text-color text-sm">Posts</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body transition-fade-up"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">JDBC</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/images/redefine-avatar.jpg"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">Lu</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2024-05-21</span> <span class="mobile">2024-05-21</span> <span class="hover-info">Created</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2025-03-11 12:44:58</span> <span class="mobile">2025-03-11 12:44:58</span> <span class="hover-info">Updated</span> </span><span class="article-categories article-meta-item"><i class="fa-regular fa-folders"></i>&nbsp;<ul><li><a href="/categories/Java/">Java</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fa-regular fa-tags"></i>&nbsp;<ul><li><a href="/tags/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/">学习总结</a>&nbsp;</li><li>| <a href="/tags/Java/">Java</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fa-regular fa-typewriter"></i>&nbsp;<span>10.5k Words</span> </span><span class="article-min2read article-meta-item"><i class="fa-regular fa-clock"></i>&nbsp;<span>44 Mins</span> </span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><h1 id="8-x数据库-JDK21版JDBC数据库连接技术"><a href="#8-x数据库-JDK21版JDBC数据库连接技术" class="headerlink" title="8.x数据库+JDK21版JDBC数据库连接技术"></a>8.x数据库+JDK21版JDBC数据库连接技术</h1><h2 id="基础篇"><a href="#基础篇" class="headerlink" title="基础篇"></a>基础篇</h2><h3 id="一、引言"><a href="#一、引言" class="headerlink" title="一、引言"></a>一、引言</h3><h4 id="1-1-数据的存储"><a href="#1-1-数据的存储" class="headerlink" title="1.1 数据的存储"></a>1.1 数据的存储</h4><blockquote><p>我们在开发Java程序时，数据都是存储在内存中，属于临时存储，当程序停止或重启时，内存中的数据就丢失了！我们为了解决数据的长期存储问题，有如下解决方案：</p><ol><li>数据通过I&#x2F;O流技术，存储在本地磁盘中，解决了持久化问题，但是没有结构和逻辑，不方便管理和维护。</li><li>通过关系型数据库，将数据按照特定的格式交由数据库管理系统维护。关系型数据库是通过库和表分隔不同的数据，表中数据存储的方式是行和列，区分相同格式不同值的数据。</li></ol></blockquote><table><thead><tr><th align="center">数据库存储数据</th></tr></thead><tbody><tr><td align="center"><img lazyload src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/lusy37/Pictures@master/202503101227795.png"></td></tr></tbody></table><h4 id="1-2-数据的操作"><a href="#1-2-数据的操作" class="headerlink" title="1.2 数据的操作"></a>1.2 数据的操作</h4><blockquote><p>数据存储在数据库，仅仅解决了我们数据存储的问题，但当我们程序运行时，需要读取数据，以及对数据做增删改的操作，那么我们如何通过Java程序对数据库中的数据做增删改查呢？</p></blockquote><table><thead><tr><th align="center">Java程序读取数据库</th></tr></thead><tbody><tr><td align="center"><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141005173.png" alt="image-20240221133525927"></td></tr></tbody></table><h3 id="二、JDBC"><a href="#二、JDBC" class="headerlink" title="二、JDBC"></a>二、JDBC</h3><h4 id="2-1-JDBC的概念"><a href="#2-1-JDBC的概念" class="headerlink" title="2.1 JDBC的概念"></a>2.1 JDBC的概念</h4><blockquote><ul><li>JDBC：Java Database Connectivity，意为Java数据库连接。</li><li>JDBC是Java提供的一组独立于任何数据库管理系统的API。</li><li>Java提供接口规范，由各个数据库厂商提供接口的实现，厂商提供的实现类封装成jar文件，也就是我们俗称的数据库驱动jar包。</li><li>学习JDBC，充分体现了面向接口编程的好处，程序员只关心标准和规范，而无需关注实现过程。</li></ul></blockquote><table><thead><tr><th align="center">JDBC简单执行过程</th></tr></thead><tbody><tr><td align="center"><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141005595.png" alt="image-20240221134431944"></td></tr></tbody></table><h4 id="2-2-JDBC的核心组成"><a href="#2-2-JDBC的核心组成" class="headerlink" title="2.2 JDBC的核心组成"></a>2.2 JDBC的核心组成</h4><ul><li>接口规范：<ul><li>为了项目代码的可移植性，可维护性，SUN公司从最初就制定了Java程序连接各种数据库的统一接口规范。这样的话，不管是连接哪一种DBMS软件，Java代码可以保持一致性。</li><li>接口存储在java.sql和javax.sql包下。</li></ul></li><li>实现规范：<ul><li>因为各个数据库厂商的DBMS软件各有不同，那么各自的内部如何通过SQL实现增、删、改、查等操作管理数据，只有这个数据库厂商自己更清楚，因此把接口规范的实现交给各个数据库厂商自己实现。</li><li>厂商将实现内容和过程封装成jar文件，我们程序员只需要将jar文件引入到项目中集成即可，就可以开发调用实现过程操作数据库了。</li></ul></li></ul><h3 id="三、JDBC快速入门"><a href="#三、JDBC快速入门" class="headerlink" title="三、JDBC快速入门"></a>三、JDBC快速入门</h3><h4 id="3-1-JDBC搭建步骤"><a href="#3-1-JDBC搭建步骤" class="headerlink" title="3.1 JDBC搭建步骤"></a>3.1 JDBC搭建步骤</h4><ol><li>准备数据库。</li><li>官网下载数据库连接驱动jar包。<a href="">https://downloads.mysql.com/archives/c-j/</a></li><li>创建Java项目，在项目下创建lib文件夹，将下载的驱动jar包复制到文件夹里。</li><li>选中lib文件夹右键-&gt;Add as Library，与项目集成。</li><li>编写代码</li></ol><h4 id="3-2-代码实现"><a href="#3-2-代码实现" class="headerlink" title="3.2 代码实现"></a>3.2 代码实现</h4><h5 id="3-2-1-数据库"><a href="#3-2-1-数据库" class="headerlink" title="3.2.1 数据库"></a>3.2.1 数据库</h5><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE atguigu;</span><br><span class="line"></span><br><span class="line">use atguigu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> t_emp</span><br><span class="line">(</span><br><span class="line">    emp_id     <span class="type">int</span> auto_increment comment <span class="string">&#x27;员工编号&#x27;</span> <span class="keyword">primary key</span>,</span><br><span class="line">    emp_name   <span class="type">varchar</span>(<span class="number">100</span>)  <span class="keyword">not null</span> comment <span class="string">&#x27;员工姓名&#x27;</span>,</span><br><span class="line">    emp_salary <span class="keyword">double</span>(<span class="number">10</span>, <span class="number">5</span>) <span class="keyword">not null</span> comment <span class="string">&#x27;员工薪资&#x27;</span>,</span><br><span class="line">    emp_age    <span class="type">int</span>           <span class="keyword">not null</span> comment <span class="string">&#x27;员工年龄&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> t_emp (emp_name,emp_salary,emp_age)</span><br><span class="line"><span class="keyword">values</span>  (<span class="string">&#x27;andy&#x27;</span>, <span class="number">777.77</span>, <span class="number">32</span>),</span><br><span class="line">        (<span class="string">&#x27;大风哥&#x27;</span>, <span class="number">666.66</span>, <span class="number">41</span>),</span><br><span class="line">        (<span class="string">&#x27;康师傅&#x27;</span>,<span class="number">111</span>, <span class="number">23</span>),</span><br><span class="line">        (<span class="string">&#x27;Gavin&#x27;</span>,<span class="number">123</span>, <span class="number">26</span>),</span><br><span class="line">        (<span class="string">&#x27;小鱼儿&#x27;</span>, <span class="number">123</span>, <span class="number">28</span>);</span><br></pre></td></tr></table></figure></div><h5 id="3-2-2-Java代码"><a href="#3-2-2-Java代码" class="headerlink" title="3.2.2 Java代码"></a>3.2.2 Java代码</h5><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcQuick</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException， SQLException &#123;</span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">      </span><br><span class="line">        <span class="comment">//2.获取数据库连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(</span><br><span class="line">        <span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.创建Statement对象</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(</span><br><span class="line">        <span class="string">&quot;select emp_id,emp_name,emp_salary,emp_age from t_emp&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.编写SQL语句并执行，获取结果</span></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.处理结果</span></span><br><span class="line">        <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">empId</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;emp_id&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">empName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;emp_name&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">empSalary</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;emp_salary&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">empAge</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;emp_age&quot;</span>);</span><br><span class="line">            System.out.println(empId + <span class="string">&quot;\t&quot;</span> + empName + <span class="string">&quot;\t&quot;</span> + empSalary + <span class="string">&quot;\t&quot;</span> + empAge);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.释放资源(先开后关原则)</span></span><br><span class="line">        resultSet.close();</span><br><span class="line">        preparedStatement.close();</span><br><span class="line">        connection.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h4 id="3-3-步骤总结"><a href="#3-3-步骤总结" class="headerlink" title="3.3 步骤总结"></a>3.3 步骤总结</h4><ol><li>注册驱动【依赖的驱动类，进行安装】</li><li>获取连接【Connection建立连接】</li><li>创建发送SQL语句对象【Connection创建发送SQL语句的Statement】</li><li>发送SQL语句，并获取返回结果【Statement 发送sql语句到数据库并且取得返回结果】</li><li>结果集解析【结果集解析，将查询结果解析出来】</li><li>资源关闭【释放ResultSet、Statement 、Connection】</li></ol><h3 id="四、核心API理解"><a href="#四、核心API理解" class="headerlink" title="四、核心API理解"></a>四、核心API理解</h3><h4 id="4-1-注册驱动"><a href="#4-1-注册驱动" class="headerlink" title="4.1 注册驱动"></a>4.1 注册驱动</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br></pre></td></tr></table></figure></div><ul><li><p>在 Java 中，当使用 JDBC（Java Database Connectivity）连接数据库时，需要加载数据库特定的驱动程序，以便与数据库进行通信。加载驱动程序的目的是为了注册驱动程序，使得 JDBC API 能够识别并与特定的数据库进行交互。</p></li><li><p>从JDK6开始，不再需要显式地调用 <code>Class.forName()</code> 来加载 JDBC 驱动程序，只要在类路径中集成了对应的jar文件，会自动在初始化时注册驱动程序。</p></li></ul><h4 id="4-2-Connection"><a href="#4-2-Connection" class="headerlink" title="4.2 Connection"></a>4.2 Connection</h4><ul><li>Connection接口是JDBC API的重要接口，用于建立与数据库的通信通道。换而言之，Connection对象不为空，则代表一次数据库连接。</li><li>在建立连接时，需要指定数据库URL、用户名、密码参数。<ul><li>URL：jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;atguigu<ul><li>jdbc:mysql:&#x2F;&#x2F;IP地址:端口号&#x2F;数据库名称?参数键值对1&amp;参数键值对2</li></ul></li></ul></li><li><code>Connection</code> 接口还负责管理事务，<code>Connection</code> 接口提供了 <code>commit</code> 和 <code>rollback</code> 方法，用于提交事务和回滚事务。</li><li>可以创建 <code>Statement</code> 对象，用于执行 SQL 语句并与数据库进行交互。</li><li>在使用JDBC技术时，必须要先获取Connection对象，在使用完毕后，要释放资源，避免资源占用浪费及泄漏。</li></ul><h4 id="4-3-Statement"><a href="#4-3-Statement" class="headerlink" title="4.3 Statement"></a>4.3 Statement</h4><ul><li><code>Statement</code> 接口用于执行 SQL 语句并与数据库进行交互。它是 JDBC API 中的一个重要接口。通过 <code>Statement</code> 对象，可以向数据库发送 SQL 语句并获取执行结果。</li><li>结果可以是一个或多个结果。<ul><li>增删改：受影响行数单个结果。</li><li>查询：单行单列、多行多列、单行多列等结果。</li></ul></li><li>但是<code>Statement</code> 接口在执行SQL语句时，会产生<code>SQL注入攻击问题</code>:<ul><li>当使用 <code>Statement</code> 执行动态构建的 SQL 查询时，往往需要将查询条件与 SQL 语句拼接在一起，直接将参数和SQL语句一并生成，让SQL的查询条件始终为true得到结果。</li></ul></li></ul><h4 id="4-4-PreparedStatement"><a href="#4-4-PreparedStatement" class="headerlink" title="4.4 PreparedStatement"></a>4.4 PreparedStatement</h4><ul><li><code>PreparedStatement</code>是 <code>Statement</code> 接口的子接口，用于执行<code>预编译</code>的 SQL 查询，作用如下：<ul><li>预编译SQL语句：在创建PreparedStatement时，就会预编译SQL语句，也就是SQL语句已经固定。</li><li>防止SQL注入：<code>PreparedStatement</code> 支持参数化查询，将数据作为参数传递到SQL语句中，采用?占位符的方式，将传入的参数用一对单引号包裹起来’’，无论传递什么都作为值。有效防止传入关键字或值导致SQL注入问题。</li><li>性能提升：PreparedStatement是预编译SQL语句，同一SQL语句多次执行的情况下，可以复用，不必每次重新编译和解析。</li></ul></li><li>后续的学习我们都是基于PreparedStatement进行实现，更安全、效率更高！</li></ul><h4 id="4-5-ResultSet"><a href="#4-5-ResultSet" class="headerlink" title="4.5 ResultSet"></a>4.5 ResultSet</h4><ul><li><code>ResultSet</code>是 JDBC API 中的一个接口，用于表示从数据库中<code>执行查询语句所返回的结果集</code>。它提供了一种用于遍历和访问查询结果的方式。</li><li>遍历结果：ResultSet可以使用 <code>next()</code> 方法将游标移动到结果集的下一行，逐行遍历数据库查询的结果，返回值为boolean类型，true代表有下一行结果，false则代表没有。</li><li>获取单列结果：可以通过getXxx的方法获取单列的数据，该方法为重载方法，支持索引和列名进行获取。</li></ul><h3 id="五、基于PreparedStatement实现CRUD"><a href="#五、基于PreparedStatement实现CRUD" class="headerlink" title="五、基于PreparedStatement实现CRUD"></a>五、基于PreparedStatement实现CRUD</h3><h4 id="5-1-查询单行单列"><a href="#5-1-查询单行单列" class="headerlink" title="5.1 查询单行单列"></a>5.1 查询单行单列</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">querySingleRowAndColumn</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">       <span class="comment">//1.注册驱动</span></span><br><span class="line">	<span class="comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//2.获取数据库连接</span></span><br><span class="line">       <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>, <span class="string">&quot;root&quot;</span>,<span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//3.创建PreparedStatement对象，并预编译SQL语句</span></span><br><span class="line">       <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(<span class="string">&quot;select count(*) as count from t_emp&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//4.执行SQL语句，获取结果</span></span><br><span class="line">       <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//5.处理结果</span></span><br><span class="line">       <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;count&quot;</span>);</span><br><span class="line">           System.out.println(<span class="string">&quot;count = &quot;</span> + count);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//6.释放资源(先开后关原则)</span></span><br><span class="line">       resultSet.close();</span><br><span class="line">       preparedStatement.close();</span><br><span class="line">       connection.close();</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div><h4 id="5-2-查询单行多列"><a href="#5-2-查询单行多列" class="headerlink" title="5.2 查询单行多列"></a>5.2 查询单行多列</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">querySingleRow</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">       <span class="comment">//1.注册驱动</span></span><br><span class="line">	<span class="comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//2.获取数据库连接</span></span><br><span class="line">       <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//3.创建PreparedStatement对象，并预编译SQL语句，使用?占位符</span></span><br><span class="line">       <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(<span class="string">&quot;select emp_id,emp_name,emp_salary,emp_age from t_emp where emp_id = ?&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//4.为占位符赋值，索引从1开始，执行SQL语句，获取结果</span></span><br><span class="line">       preparedStatement.setInt(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">       <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//5.处理结果</span></span><br><span class="line">       <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">empId</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;emp_id&quot;</span>);</span><br><span class="line">           <span class="type">String</span> <span class="variable">empName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;emp_name&quot;</span>);</span><br><span class="line">           <span class="type">String</span> <span class="variable">empSalary</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;emp_salary&quot;</span>);</span><br><span class="line">           <span class="type">int</span> <span class="variable">empAge</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;emp_age&quot;</span>);</span><br><span class="line">           System.out.println(empId+<span class="string">&quot;\t&quot;</span>+empName+<span class="string">&quot;\t&quot;</span>+empSalary+<span class="string">&quot;\t&quot;</span>+empAge);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//6.释放资源(先开后关原则)</span></span><br><span class="line">       resultSet.close();</span><br><span class="line">       preparedStatement.close();</span><br><span class="line">       connection.close();</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div><h4 id="5-3-查询多行多列"><a href="#5-3-查询多行多列" class="headerlink" title="5.3 查询多行多列"></a>5.3 查询多行多列</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryMoreRow</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">       <span class="comment">//1.注册驱动</span></span><br><span class="line">	<span class="comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//2.获取数据库连接</span></span><br><span class="line">       <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//3.创建Statement对象</span></span><br><span class="line">       <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(<span class="string">&quot;select emp_id,emp_name,emp_salary,emp_age from t_emp&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//4.编写SQL语句并执行，获取结果</span></span><br><span class="line">       <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       <span class="comment">//5.处理结果</span></span><br><span class="line">       <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">empId</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;emp_id&quot;</span>);</span><br><span class="line">           <span class="type">String</span> <span class="variable">empName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;emp_name&quot;</span>);</span><br><span class="line">           <span class="type">String</span> <span class="variable">empSalary</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;emp_salary&quot;</span>);</span><br><span class="line">           <span class="type">int</span> <span class="variable">empAge</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;emp_age&quot;</span>);</span><br><span class="line">           System.out.println(empId+<span class="string">&quot;\t&quot;</span>+empName+<span class="string">&quot;\t&quot;</span>+empSalary+<span class="string">&quot;\t&quot;</span>+empAge);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//6.释放资源(先开后关原则)</span></span><br><span class="line">       resultSet.close();</span><br><span class="line">       preparedStatement.close();</span><br><span class="line">       connection.close();</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div><h4 id="5-4-新增"><a href="#5-4-新增" class="headerlink" title="5.4 新增"></a>5.4 新增</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line"><span class="comment">//        Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.获取数据库连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>,<span class="string">&quot;root&quot;</span>, <span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.创建Statement对象</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(<span class="string">&quot;insert into t_emp (emp_name,emp_salary,emp_age)values  (?, ?,?)&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.为占位符赋值，索引从1开始，编写SQL语句并执行，获取结果</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,<span class="string">&quot;rose&quot;</span>);</span><br><span class="line">        preparedStatement.setDouble(<span class="number">2</span>,<span class="number">666.66</span>);</span><br><span class="line">        preparedStatement.setDouble(<span class="number">3</span>,<span class="number">28</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.处理结果</span></span><br><span class="line">        <span class="keyword">if</span>(result&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;添加成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.释放资源(先开后关原则)</span></span><br><span class="line">        preparedStatement.close();</span><br><span class="line">        connection.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><h4 id="5-5-修改"><a href="#5-5-修改" class="headerlink" title="5.5 修改"></a>5.5 修改</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line"><span class="comment">//        Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.获取数据库连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.创建Statement对象</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(<span class="string">&quot;update t_emp set emp_salary = ? where emp_id = ?&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.为占位符赋值，索引从1开始，编写SQL语句并执行，获取结果</span></span><br><span class="line">        preparedStatement.setDouble(<span class="number">1</span>,<span class="number">888.88</span>);</span><br><span class="line">        preparedStatement.setDouble(<span class="number">2</span>,<span class="number">8</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.处理结果</span></span><br><span class="line">        <span class="keyword">if</span>(result&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.释放资源(先开后关原则)</span></span><br><span class="line">        preparedStatement.close();</span><br><span class="line">        connection.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><h4 id="5-6-删除"><a href="#5-6-删除" class="headerlink" title="5.6 删除"></a>5.6 删除</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//1.注册驱动</span></span><br><span class="line"><span class="comment">//        Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.获取数据库连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.创建Statement对象</span></span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(<span class="string">&quot;delete from t_emp where emp_id = ?&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.为占位符赋值，索引从1开始，编写SQL语句并执行，获取结果</span></span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,<span class="number">8</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.处理结果</span></span><br><span class="line">        <span class="keyword">if</span>(result&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.释放资源(先开后关原则)</span></span><br><span class="line">        preparedStatement.close();</span><br><span class="line">        connection.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><h3 id="六、常见问题"><a href="#六、常见问题" class="headerlink" title="六、常见问题"></a>六、常见问题</h3><h4 id="6-1-资源的管理"><a href="#6-1-资源的管理" class="headerlink" title="6.1 资源的管理"></a>6.1 资源的管理</h4><blockquote><p>在使用JDBC的相关资源时，比如Connection、PreparedStatement、ResultSet，使用完毕后，要及时关闭这些资源以释放数据库服务器资源和避免内存泄漏是很重要的。</p></blockquote><h4 id="6-2-SQL语句问题"><a href="#6-2-SQL语句问题" class="headerlink" title="6.2 SQL语句问题"></a>6.2 SQL语句问题</h4><blockquote><p>java.sql.SQLSyntaxErrorException：SQL语句错误异常，一般有几种可能：</p><ol><li>SQL语句有错误，检查SQL语句！建议SQL语句在SQL工具中测试后再复制到Java程序中！</li><li>连接数据库的URL中，数据库名称编写错误，也会报该异常！</li></ol><p><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141006352.png" alt="image-20240223143826507"></p></blockquote><h4 id="6-3-SQL语句未设置参数问题"><a href="#6-3-SQL语句未设置参数问题" class="headerlink" title="6.3 SQL语句未设置参数问题"></a>6.3 SQL语句未设置参数问题</h4><blockquote><p>java.sql.SQLException：No value specified for parameter 1</p><p>在使用预编译SQL语句时，如果有?占位符，要为每一个占位符赋值，否则报该错误！</p><p><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141006966.png" alt="image-20240223143947558"></p></blockquote><h4 id="6-4-用户名或密码错误问题"><a href="#6-4-用户名或密码错误问题" class="headerlink" title="6.4 用户名或密码错误问题"></a>6.4 用户名或密码错误问题</h4><blockquote><p>连接数据库时，如果用户名或密码输入错误，也会报SQLException，容易混淆！所以一定要看清楚异常后面的原因描述</p><p><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141006121.png" alt="image-20240223144345939"></p></blockquote><h4 id="6-5-通信异常"><a href="#6-5-通信异常" class="headerlink" title="6.5 通信异常"></a>6.5 通信异常</h4><blockquote><p>在连接数据库的URL中，如果IP或端口写错了，会报如下异常：</p><p>com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure</p><p><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141006389.png" alt="image-20240227234754309"></p></blockquote><h2 id="进阶篇"><a href="#进阶篇" class="headerlink" title="进阶篇"></a>进阶篇</h2><h3 id="七、JDBC扩展"><a href="#七、JDBC扩展" class="headerlink" title="七、JDBC扩展"></a>七、JDBC扩展</h3><h4 id="7-1-实体类和ORM"><a href="#7-1-实体类和ORM" class="headerlink" title="7.1 实体类和ORM"></a>7.1 实体类和ORM</h4><blockquote><ul><li>在使用JDBC操作数据库时，我们会发现数据都是零散的，明明在数据库中是一行完整的数据，到了Java中变成了一个一个的变量，不利于维护和管理。而我们Java是面向对象的，一个表对应的是一个类，一行数据就对应的是Java中的一个对象，一个列对应的是对象的属性，所以我们要把数据存储在一个载体里，这个载体就是实体类！</li><li>ORM（Object Relational Mapping）思想，<strong>对象到关系数据库的映射</strong>，作用是在编程中，把面向对象的概念跟数据库中表的概念对应起来，以面向对象的角度操作数据库中的数据，即一张表对应一个类，一行数据对应一个对象，一个列对应一个属性！</li><li>当下JDBC中这种过程我们称其为手动ORM。后续我们也会学习ORM框架，比如MyBatis、JPA等。</li></ul></blockquote><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.pojo;</span><br><span class="line"><span class="comment">//类名和数据库名对应，但是表名一般缩写，类名要全写！</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer empId;<span class="comment">//emp_id = empId 数据库中列名用下划线分隔，属性名用驼峰！</span></span><br><span class="line">    <span class="keyword">private</span> String empName;<span class="comment">//emp_name = empName</span></span><br><span class="line">    <span class="keyword">private</span> Double empSalary;<span class="comment">//emp_salary = empSalary</span></span><br><span class="line">    <span class="keyword">private</span> Integer empAge;<span class="comment">//emp_age = empAge</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//省略get、set、无参、有参、toString方法。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>封装代码：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">querySingleRow</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;  </span><br><span class="line">    <span class="comment">//1.注册驱动  </span></span><br><span class="line">    <span class="comment">// Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);  </span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">//2.获取数据库连接  </span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(  </span><br><span class="line">            <span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>, <span class="string">&quot;root&quot;</span>,<span class="string">&quot;atguigu&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//3.创建PreparedStatement对象，并预编译SQL语句，使用?占位符  </span></span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(  </span><br><span class="line">            <span class="string">&quot;select emp_id,emp_name,emp_salary,emp_age from t_emp where emp_id = ?&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//4.为占位符赋值，索引从1开始，执行SQL语句，获取结果  </span></span><br><span class="line">    preparedStatement.setInt(<span class="number">1</span>, <span class="number">1</span>);  </span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.executeQuery();  </span><br><span class="line">    <span class="comment">//预先创建实体类变量  </span></span><br><span class="line">    <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> <span class="literal">null</span>;  </span><br><span class="line">    <span class="comment">//5.处理结果  </span></span><br><span class="line">    <span class="keyword">while</span> (resultSet.next()) &#123;  </span><br><span class="line">        <span class="type">int</span> <span class="variable">empId</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;emp_id&quot;</span>);  </span><br><span class="line">        <span class="type">String</span> <span class="variable">empName</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;emp_name&quot;</span>);  </span><br><span class="line">        <span class="type">Double</span> <span class="variable">empSalary</span> <span class="operator">=</span> Double.valueOf(resultSet.getString(<span class="string">&quot;emp_salary&quot;</span>));  </span><br><span class="line">        <span class="type">int</span> <span class="variable">empAge</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;emp_age&quot;</span>);  </span><br><span class="line">        <span class="comment">//当结果集中有数据，再进行对象的创建  </span></span><br><span class="line">        employee = <span class="keyword">new</span> <span class="title class_">Employee</span>(empId,empName,empSalary,empAge);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    System.out.println(<span class="string">&quot;employee = &quot;</span> + employee);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//6.释放资源(先开后关原则)  </span></span><br><span class="line">    resultSet.close();  </span><br><span class="line">    preparedStatement.close();  </span><br><span class="line">    connection.close();  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="7-2-主键回显"><a href="#7-2-主键回显" class="headerlink" title="7.2 主键回显"></a>7.2 主键回显</h4><ul><li><p>在数据中，执行新增操作时，主键列为自动增长，可以在表中直观的看到，但是在Java程序中，我们执行完新增后，只能得到受影响行数，无法得知当前新增数据的主键值。在Java程序中获取数据库中插入新数据后的主键值，并赋值给Java对象，此操作为主键回显。</p></li><li><p>代码实现：</p></li></ul><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReturnPK</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;  </span><br><span class="line">    <span class="comment">//1.注册驱动  </span></span><br><span class="line">    <span class="comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);  </span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">//2.获取数据库连接  </span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(</span><br><span class="line">    <span class="string">&quot;jdbc:mysql://localhost:3306/atguigu&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;atguigu&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//3.创建preparedStatement对象，传入需要主键回显参数Statement.RETURN_GENERATED_KEYS  </span></span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(</span><br><span class="line">    <span class="string">&quot;insert into t_emp (emp_name, emp_salary, emp_age)values  (?, ?,?)&quot;</span>,</span><br><span class="line">    Statement.RETURN_GENERATED_KEYS);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//4.编写SQL语句并执行，获取结果  </span></span><br><span class="line">    <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="literal">null</span>,<span class="string">&quot;rose&quot;</span>,<span class="number">666.66</span>,<span class="number">28</span>);  </span><br><span class="line">    preparedStatement.setString(<span class="number">1</span>,employee.getEmpName());  </span><br><span class="line">    preparedStatement.setDouble(<span class="number">2</span>,employee.getEmpSalary());  </span><br><span class="line">    preparedStatement.setDouble(<span class="number">3</span>,employee.getEmpAge());  </span><br><span class="line">    <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> preparedStatement.executeUpdate();  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//5.处理结果  </span></span><br><span class="line">    <span class="keyword">if</span>(result&gt;<span class="number">0</span>)&#123;  </span><br><span class="line">        System.out.println(<span class="string">&quot;添加成功&quot;</span>);  </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">&quot;添加失败&quot;</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//6.获取生成的主键列值，返回的是resultSet，在结果集中获取主键列值  </span></span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> preparedStatement.getGeneratedKeys();  </span><br><span class="line">    <span class="keyword">if</span> (resultSet.next())&#123;  </span><br><span class="line">        <span class="type">int</span> <span class="variable">empId</span> <span class="operator">=</span> resultSet.getInt(<span class="number">1</span>);  </span><br><span class="line">        <span class="comment">//或者把1替换成GENERATED_KEY，</span></span><br><span class="line">        <span class="comment">//注意这里的表格是数据库驱动返回的生成键的列名`GENERATED_KEY`，而不是你在表中定义的`emp_id`</span></span><br><span class="line">        employee.setEmpId(empId);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    System.out.println(employee.toString());  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//7.释放资源(先开后关原则)  </span></span><br><span class="line">    resultSet.close();  </span><br><span class="line">    preparedStatement.close();  </span><br><span class="line">    connection.close();  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="7-3-批量操作"><a href="#7-3-批量操作" class="headerlink" title="7.3 批量操作"></a>7.3 批量操作</h4><ul><li><p>插入多条数据时，一条一条发送给数据库执行，效率低下！</p></li><li><p>通过批量操作，可以提升多次操作效率！</p></li><li><p>代码实现：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBatch</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;  </span><br><span class="line">    <span class="comment">//1.注册驱动  </span></span><br><span class="line">    <span class="comment">//        Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);  </span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">//2.获取连接  </span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(</span><br><span class="line">    <span class="string">&quot;jdbc:mysql:///atguigu?rewriteBatchedStatements=true&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;atguigu&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//3.编写SQL语句  </span></span><br><span class="line">      <span class="comment">/*  </span></span><br><span class="line"><span class="comment">          注意：1、必须在连接数据库的URL后面追加?rewriteBatchedStatements=true，允许批量操作  </span></span><br><span class="line"><span class="comment">              2、新增SQL必须用values。且语句最后不要追加;结束  </span></span><br><span class="line"><span class="comment">              3、调用addBatch()方法，将SQL语句进行批量添加操作  </span></span><br><span class="line"><span class="comment">              4、统一执行批量操作，调用executeBatch()  </span></span><br><span class="line"><span class="comment">       */</span>    </span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_emp (emp_name,emp_salary,emp_age) values (?,?,?)&quot;</span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//4.创建预编译的PreparedStatement，传入SQL语句  </span></span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//获取当前行代码执行的时间。毫秒值  </span></span><br><span class="line">    <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();  </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">10000</span>;i++)&#123;  </span><br><span class="line">        <span class="comment">//5.为占位符赋值  </span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>, <span class="string">&quot;marry&quot;</span>+i);  </span><br><span class="line">        preparedStatement.setDouble(<span class="number">2</span>, <span class="number">100.0</span>+i);  </span><br><span class="line">        preparedStatement.setInt(<span class="number">3</span>, <span class="number">20</span>+i);  </span><br><span class="line">  </span><br><span class="line">        preparedStatement.addBatch();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//执行批量操作  </span></span><br><span class="line">    preparedStatement.executeBatch();  </span><br><span class="line">  </span><br><span class="line">    <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();  </span><br><span class="line">  </span><br><span class="line">    System.out.println(<span class="string">&quot;消耗时间：&quot;</span>+(end - start));  </span><br><span class="line">  </span><br><span class="line">    preparedStatement.close();  </span><br><span class="line">    connection.close();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ul><h3 id="八、连接池"><a href="#八、连接池" class="headerlink" title="八、连接池"></a>八、连接池</h3><h4 id="8-1-现有问题"><a href="#8-1-现有问题" class="headerlink" title="8.1 现有问题"></a>8.1 现有问题</h4><blockquote><ul><li>每次操作数据库都要获取新连接，使用完毕后就close释放，频繁的创建和销毁造成资源浪费。</li><li>连接的数量无法把控，对服务器来说压力巨大。</li></ul></blockquote><h4 id="8-2-连接池"><a href="#8-2-连接池" class="headerlink" title="8.2 连接池"></a>8.2 连接池</h4><blockquote><p>连接池就是数据库连接对象的缓冲区，通过配置，由连接池负责创建连接、管理连接、释放连接等操作。</p><p>预先创建数据库连接放入连接池，用户在请求时，通过池直接获取连接，使用完毕后，将连接放回池中，避免了频繁的创建和销毁，同时解决了创建的效率。</p><p>当池中无连接可用，且未达到上限时，连接池会新建连接。</p><p>池中连接达到上限，用户请求会等待，可以设置超时时间。</p></blockquote><h4 id="8-3-常见连接池"><a href="#8-3-常见连接池" class="headerlink" title="8.3 常见连接池"></a>8.3 常见连接池</h4><p>JDBC 的数据库连接池使用 javax.sql.DataSource接口进行规范，所有的第三方连接池都实现此接口，自行添加具体实现！也就是说，所有连接池获取连接的和回收连接方法都一样，不同的只有性能和扩展功能!</p><ul><li>DBCP 是Apache提供的数据库连接池，速度相对C3P0较快，但自身存在一些BUG。</li><li>C3P0 是一个开源组织提供的一个数据库连接池，速度相对较慢，稳定性还可以。</li><li>Proxool 是sourceforge下的一个开源项目数据库连接池，有监控连接池状态的功能， 稳定性较c3p0差一点</li><li><strong>Druid 是阿里提供的数据库连接池，是集DBCP 、C3P0 、Proxool 优点于一身的数据库连接池，性能、扩展性、易用性都更好，功能丰富</strong>。</li><li><strong>Hikari（ひかり[shi ga li]） 取自日语，是光的意思，是SpringBoot2.x之后内置的一款连接池，基于 BoneCP （已经放弃维护，推荐该连接池）做了不少的改进和优化，口号是快速、简单、可靠。</strong></li></ul><table><thead><tr><th align="center">主流连接池的功能对比</th></tr></thead><tbody><tr><td align="center"><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141006585.png" alt="image-20240228090209040"></td></tr></tbody></table><table><thead><tr><th align="center">mock性能数据（单位：ms）</th></tr></thead><tbody><tr><td align="center"><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141007938.png" alt="image-20240228205157212"></td></tr></tbody></table><table><thead><tr><th align="center">mysql性能数据 (单位：ms)</th></tr></thead><tbody><tr><td align="center"><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141007670.png" alt="image-20240228205242420"></td></tr></tbody></table><h4 id="8-4-Druid连接池使用"><a href="#8-4-Druid连接池使用" class="headerlink" title="8.4 Druid连接池使用"></a>8.4 Druid连接池使用</h4><ul><li><p>使用步骤：</p><ul><li>引入jar包。</li><li>编码。</li></ul></li><li><p>代码实现：</p><ul><li><p>硬编码方式（了解）：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testHardCodeDruid</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        硬编码：将连接池的配置信息和Java代码耦合在一起。</span></span><br><span class="line"><span class="comment">        1、创建DruidDataSource连接池对象。</span></span><br><span class="line"><span class="comment">        2、设置连接池的配置信息【必须 | 非必须】</span></span><br><span class="line"><span class="comment">        3、通过连接池获取连接对象</span></span><br><span class="line"><span class="comment">        4、回收连接【不是释放连接，而是将连接归还给连接池，给其他线程进行复用】</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.创建DruidDataSource连接池对象。</span></span><br><span class="line">    <span class="type">DruidDataSource</span> <span class="variable">druidDataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.设置连接池的配置信息【必须 | 非必须】</span></span><br><span class="line">    <span class="comment">//2.1 必须设置的配置</span></span><br><span class="line">    druidDataSource.setDriverClassName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">    druidDataSource.setUrl(<span class="string">&quot;jdbc:mysql:///atguigu&quot;</span>);</span><br><span class="line">    druidDataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    druidDataSource.setPassword(<span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.2 非必须设置的配置</span></span><br><span class="line">    druidDataSource.setInitialSize(<span class="number">10</span>);</span><br><span class="line">    druidDataSource.setMaxActive(<span class="number">20</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//3.通过连接池获取连接对象</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> druidDataSource.getConnection();</span><br><span class="line">    System.out.println(connection);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//基于connection进行CRUD</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.回收连接</span></span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>软编码方式（推荐）：</p><ul><li>在项目目录下创建resources文件夹，标识该文件夹为资源目录，创建db.properties配置文件，将连接信息定义在该文件中。</li></ul><div class="code-container" data-rel="Properties"><figure class="iseeu highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># druid连接池需要的配置参数，key固定命名</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql:///atguigu</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">atguigu</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">10</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">20</span></span><br></pre></td></tr></table></figure></div><ul><li>Java代码：</li></ul><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testResourcesDruid</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;  </span><br><span class="line">    <span class="comment">//1.创建Properties集合，用于存储外部配置文件的key和value值。  </span></span><br><span class="line">    <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//2.读取外部配置文件，获取输入流，加载到Properties集合里。  </span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> DruidTest.class  </span><br><span class="line">            .getClassLoader()  </span><br><span class="line">            .getResourceAsStream(<span class="string">&quot;db.properties&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">    properties.load(inputStream);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//3.基于Properties集合构建DruidDataSource连接池  </span></span><br><span class="line">    <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> DruidDataSourceFactory.createDataSource(properties);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//4.通过连接池获取连接对象  </span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> dataSource.getConnection();  </span><br><span class="line">    System.out.println(connection);  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//5.开发CRUD  </span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">//6.回收连接  </span></span><br><span class="line">    connection.close();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ul></li></ul><h4 id="8-5-Druid其他配置【了解】"><a href="#8-5-Druid其他配置【了解】" class="headerlink" title="8.5 Druid其他配置【了解】"></a>8.5 Druid其他配置【了解】</h4><table><thead><tr><th>配置</th><th><strong>缺省</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>name</td><td></td><td>配置这个属性的意义在于，如果存在多个数据源，监控的时候可以通过名字来区分开来。 如果没有配置，将会生成一个名字，格式是：”DataSource-” + System.identityHashCode(this)</td></tr><tr><td>jdbcUrl</td><td></td><td>连接数据库的url，不同数据库不一样。例如：mysql : jdbc:mysql:&#x2F;&#x2F;10.20.153.104:3306&#x2F;druid2 oracle : jdbc:oracle:thin:@10.20.149.85:1521:ocnauto</td></tr><tr><td>username</td><td></td><td>连接数据库的用户名</td></tr><tr><td>password</td><td></td><td>连接数据库的密码。如果你不希望密码直接写在配置文件中，可以使用ConfigFilter。详细看这里：<a class="link" target="_blank" rel="noopener" href="https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter">https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></td></tr><tr><td>driverClassName</td><td></td><td>根据url自动识别 这一项可配可不配，如果不配置druid会根据url自动识别dbType，然后选择相应的driverClassName(建议配置下)</td></tr><tr><td>initialSize</td><td>0</td><td>初始化时建立物理连接的个数。初始化发生在显示调用init方法，或者第一次getConnection时</td></tr><tr><td>maxActive</td><td>8</td><td>最大连接池数量</td></tr><tr><td>maxIdle</td><td>8</td><td>已经不再使用，配置了也没效果</td></tr><tr><td>minIdle</td><td></td><td>最小连接池数量</td></tr><tr><td>maxWait</td><td></td><td>获取连接时最大等待时间，单位毫秒。配置了maxWait之后，缺省启用公平锁，并发效率会有所下降，如果需要可以通过配置useUnfairLock属性为true使用非公平锁。</td></tr><tr><td>poolPreparedStatements</td><td>false</td><td>是否缓存preparedStatement，也就是PSCache。PSCache对支持游标的数据库性能提升巨大，比如说oracle。在mysql下建议关闭。</td></tr><tr><td>maxOpenPreparedStatements</td><td>-1</td><td>要启用PSCache，必须配置大于0，当大于0时，poolPreparedStatements自动触发修改为true。在Druid中，不会存在Oracle下PSCache占用内存过多的问题，可以把这个数值配置大一些，比如说100</td></tr><tr><td>validationQuery</td><td></td><td>用来检测连接是否有效的sql，要求是一个查询语句。如果validationQuery为null，testOnBorrow、testOnReturn、testWhileIdle都不会其作用。</td></tr><tr><td>testOnBorrow</td><td>true</td><td>申请连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能。</td></tr><tr><td>testOnReturn</td><td>false</td><td>归还连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能</td></tr><tr><td>testWhileIdle</td><td>false</td><td>建议配置为true，不影响性能，并且保证安全性。申请连接的时候检测，如果空闲时间大于timeBetweenEvictionRunsMillis，执行validationQuery检测连接是否有效。</td></tr><tr><td>timeBetweenEvictionRunsMillis</td><td></td><td>有两个含义： 1)Destroy线程会检测连接的间隔时间2)testWhileIdle的判断依据，详细看testWhileIdle属性的说明</td></tr><tr><td>numTestsPerEvictionRun</td><td></td><td>不再使用，一个DruidDataSource只支持一个EvictionRun</td></tr><tr><td>minEvictableIdleTimeMillis</td><td></td><td></td></tr><tr><td>connectionInitSqls</td><td></td><td>物理连接初始化的时候执行的sql</td></tr><tr><td>exceptionSorter</td><td></td><td>根据dbType自动识别 当数据库抛出一些不可恢复的异常时，抛弃连接</td></tr><tr><td>filters</td><td></td><td>属性类型是字符串，通过别名的方式配置扩展插件，常用的插件有： 监控统计用的filter:stat日志用的filter:log4j防御sql注入的filter:wall</td></tr><tr><td>proxyFilters</td><td></td><td>类型是List，如果同时配置了filters和proxyFilters，是组合关系，并非替换关系</td></tr></tbody></table><h4 id="8-6-HikariCP连接池使用"><a href="#8-6-HikariCP连接池使用" class="headerlink" title="8.6 HikariCP连接池使用"></a>8.6 HikariCP连接池使用</h4><ul><li><p>使用步骤：</p><ul><li><p>引入jar包</p></li><li><p>硬编码方式：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testHardCodeHikari</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     硬编码：将连接池的配置信息和Java代码耦合在一起。</span></span><br><span class="line"><span class="comment">     1、创建HikariDataSource连接池对象</span></span><br><span class="line"><span class="comment">     2、设置连接池的配置信息【必须 ｜ 非必须】</span></span><br><span class="line"><span class="comment">     3、通过连接池获取连接对象</span></span><br><span class="line"><span class="comment">     4、回收连接</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//1.创建HikariDataSource连接池对象</span></span><br><span class="line">    <span class="type">HikariDataSource</span> <span class="variable">hikariDataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HikariDataSource</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.设置连接池的配置信息【必须 ｜ 非必须】</span></span><br><span class="line">    <span class="comment">//2.1必须设置的配置</span></span><br><span class="line">    hikariDataSource.setDriverClassName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">    hikariDataSource.setJdbcUrl(<span class="string">&quot;jdbc:mysql:///atguigu&quot;</span>);</span><br><span class="line">    hikariDataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    hikariDataSource.setPassword(<span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.2 非必须设置的配置</span></span><br><span class="line">    hikariDataSource.setMinimumIdle(<span class="number">10</span>);</span><br><span class="line">    hikariDataSource.setMaximumPoolSize(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.通过连接池获取连接对象</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> hikariDataSource.getConnection();</span><br><span class="line"></span><br><span class="line">    System.out.println(connection);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//回收连接</span></span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>软编码方式：</p><ul><li><p>在项目下创建resources&#x2F;hikari.properties配置文件</p><div class="code-container" data-rel="Properties"><figure class="iseeu highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbcUrl</span>=<span class="string">jdbc:mysql:///atguigu</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">atguigu</span></span><br><span class="line"><span class="attr">minimumIdle</span>=<span class="string">10</span></span><br><span class="line"><span class="attr">maximumPoolSize</span>=<span class="string">20</span></span><br></pre></td></tr></table></figure></div></li><li><p>编写代码：<br></p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testResourcesHikari</span><span class="params">()</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">         <span class="comment">//1.创建Properties集合，用于存储外部配置文件的key和value值。</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//2.读取外部配置文件，获取输入流，加载到Properties集合里。</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> HikariTest.class.getClassLoader().getResourceAsStream(<span class="string">&quot;db.properties&quot;</span>);</span><br><span class="line">        properties.load(inputStream);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.创建Hikari连接池配置对象，将Properties集合传进去</span></span><br><span class="line">        <span class="type">HikariConfig</span> <span class="variable">hikariConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HikariConfig</span>(properties);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. 基于Hikari配置对象，构建连接池</span></span><br><span class="line">        <span class="type">HikariDataSource</span> <span class="variable">hikariDataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HikariDataSource</span>(hikariConfig);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5. 获取连接</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> hikariDataSource.getConnection();</span><br><span class="line">        System.out.println(<span class="string">&quot;connection = &quot;</span> + connection);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//6.回收连接</span></span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p></p></li></ul></li></ul></li></ul><h4 id="8-7-HikariCP其他配置【了解】"><a href="#8-7-HikariCP其他配置【了解】" class="headerlink" title="8.7 HikariCP其他配置【了解】"></a>8.7 HikariCP其他配置【了解】</h4><table><thead><tr><th>属性</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>isAutoCommit</td><td>true</td><td>自动提交从池中返回的连接</td></tr><tr><td>connectionTimeout</td><td>30000</td><td>等待来自池的连接的最大毫秒数</td></tr><tr><td>maxLifetime</td><td>1800000</td><td>池中连接最长生命周期如果不等于0且小于30秒则会被重置回30分钟</td></tr><tr><td>minimumIdle</td><td>10</td><td>池中维护的最小空闲连接数 minIdle&lt;0或者minIdle&gt;maxPoolSize，则被重置为maxPoolSize</td></tr><tr><td>maximumPoolSize</td><td>10</td><td>池中最大连接数，包括闲置和使用中的连接</td></tr><tr><td>metricRegistry</td><td>null</td><td>连接池的用户定义名称，主要出现在日志记录和JMX管理控制台中以识别池和池配置</td></tr><tr><td>healthCheckRegistry</td><td>null</td><td>报告当前健康信息</td></tr><tr><td>poolName</td><td>HikariPool-1</td><td>连接池的用户定义名称，主要出现在日志记录和JMX管理控制台中以识别池和池配置</td></tr><tr><td>idleTimeout</td><td></td><td>是允许连接在连接池中空闲的最长时间</td></tr></tbody></table><h2 id="高级篇"><a href="#高级篇" class="headerlink" title="高级篇"></a>高级篇</h2><h3 id="九、JDBC优化及工具类封装"><a href="#九、JDBC优化及工具类封装" class="headerlink" title="九、JDBC优化及工具类封装"></a>九、JDBC优化及工具类封装</h3><h4 id="9-1-现有问题"><a href="#9-1-现有问题" class="headerlink" title="9.1 现有问题"></a>9.1 现有问题</h4><blockquote><p>我们在使用JDBC的过程中，发现部分代码存在冗余的问题：</p><ul><li>创建连接池。</li><li>获取连接。</li><li>连接的回收。</li></ul></blockquote><h4 id="9-2-JDBC工具类封装V1-0"><a href="#9-2-JDBC工具类封装V1-0" class="headerlink" title="9.2 JDBC工具类封装V1.0"></a>9.2 JDBC工具类封装V1.0</h4><ul><li><p>resources&#x2F;db.properties配置文件：</p><div class="code-container" data-rel="Properties"><figure class="iseeu highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># druid连接池需要的配置参数，key固定命名</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">atguigu</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql:///atguigu</span></span><br></pre></td></tr></table></figure></div></li><li><p>工具类代码：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*	JDBC工具类（V1.0）：</span></span><br><span class="line"><span class="comment">*		1、维护一个连接池对象。</span></span><br><span class="line"><span class="comment">*		2、对外提供在连接池中获取连接的方法</span></span><br><span class="line"><span class="comment">*		3、对外提供回收连接的方法</span></span><br><span class="line"><span class="comment">*	注意：工具类仅对外提供共性的功能代码，所以方法均为静态方法！</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTools</span> &#123;</span><br><span class="line">    <span class="comment">//创建连接池引用，因为要提供给当前项目全局使用，所以创建为静态的。</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DataSource dataSource;</span><br><span class="line">    <span class="comment">//在项目启动时，即创建连接池对象，赋值给dataSource</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span>  JDBCTools.getClass()</span><br><span class="line">            .getClassLoader()</span><br><span class="line">            .getSystemResourceAsStream(<span class="string">&quot;db.properties&quot;</span>);</span><br><span class="line">            properties.load(inputStream);</span><br><span class="line">            dataSource = DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//对外提供获取连接的静态方法！</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//对外提供回收连接的静态方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">(Connection conn)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        conn.close();<span class="comment">//还给连接池</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>注意：此种封装方式，无法保证单个请求连接的线程，多次操作数据库时，连接是同一个，无法保证事务！</p></li></ul><h4 id="9-3-ThreadLocal"><a href="#9-3-ThreadLocal" class="headerlink" title="9.3 ThreadLocal"></a>9.3 ThreadLocal</h4><blockquote><p>JDK 1.2的版本中就提供java.lang.ThreadLocal，为解决多线程程序的并发问题提供了一种新的思路。使用这个工具类可以很简洁地编写出优美的多线程程序。通常用来在在多线程中管理共享数据库连接、Session等。</p><p>ThreadLocal用于保存某个线程共享变量，原因是在Java中，每一个线程对象中都有一个ThreadLocalMap&lt;ThreadLocal， Object&gt;，其key就是一个ThreadLocal，而Object即为该线程的共享变量。</p><p>而这个map是通过ThreadLocal的set和get方法操作的。对于同一个static ThreadLocal，不同线程只能从中get，set，remove自己的变量，而不会影响其他线程的变量。</p><ul><li>在进行对象跨层传递的时候，使用ThreadLocal可以避免多次传递，打破层次间的约束。</li><li>线程间数据隔离。</li><li>进行事务操作，用于存储线程事务信息。</li><li>数据库连接，<code>Session</code>会话管理。</li></ul><p>1、ThreadLocal对象.get: 获取ThreadLocal中当前线程共享变量的值。</p><p>2、ThreadLocal对象.set: 设置ThreadLocal中当前线程共享变量的值。</p><p>3、ThreadLocal对象.remove: 移除ThreadLocal中当前线程共享变量的值。</p></blockquote><p><img lazyload src="/images/loading.svg" data-src="https://gitee.com/lusy37/typora/raw/master/202409141007179.png" alt="image-20240223104919548"></p><h4 id="9-4-JDBC工具类封装V2-0"><a href="#9-4-JDBC工具类封装V2-0" class="headerlink" title="9.4 JDBC工具类封装V2.0"></a>9.4 JDBC工具类封装V2.0</h4><blockquote><p>在V1.0的版本基础上，我们将连接对象放在每个线程的ThreadLocal中，保证从头到尾当前线程操作的是同一连接对象。</p></blockquote><p>代码实现：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.senior.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  JDBC工具类（V2.0）：</span></span><br><span class="line"><span class="comment"> *      1、维护一个连接池对象、维护了一个线程绑定变量的ThreadLocal对象</span></span><br><span class="line"><span class="comment"> *      2、对外提供在ThreadLocal中获取连接的方法</span></span><br><span class="line"><span class="comment"> *      3、对外提供回收连接的方法，回收过程中，将要回收的连接从ThreadLocal中移除！</span></span><br><span class="line"><span class="comment"> *  注意：工具类仅对外提供共性的功能代码，所以方法均为静态方法！</span></span><br><span class="line"><span class="comment"> *  注意：使用ThreadLocal就是为了一个线程在多次数据库操作过程中，使用的是同一个连接！</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCUtilV2</span> &#123;</span><br><span class="line">    <span class="comment">//创建连接池引用，因为要提供给当前项目的全局使用，所以创建为静态的。</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DataSource dataSource;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Connection&gt; threadLocal = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在项目启动时，即创建连接池对象，赋值给dataSource</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> JDBCUtil.class.getClassLoader().getResourceAsStream(<span class="string">&quot;db.properties&quot;</span>);</span><br><span class="line">            properties.load(inputStream);</span><br><span class="line"></span><br><span class="line">            dataSource = DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//对外提供在连接池中获取连接的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//在ThreadLocal中获取Connection、</span></span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> threadLocal.get();</span><br><span class="line">            <span class="comment">//threadLocal里没有存储Connection，也就是第一次获取</span></span><br><span class="line">            <span class="keyword">if</span> (connection == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">//在连接池中获取一个连接，存储在threadLocal里。</span></span><br><span class="line">                connection = dataSource.getConnection();</span><br><span class="line">                threadLocal.set(connection);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> connection;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//对外提供回收连接的方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> threadLocal.get();</span><br><span class="line">            <span class="keyword">if</span>(connection!=<span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="comment">//从threadLocal中移除当前已经存储的Connection对象</span></span><br><span class="line">                threadLocal.remove();</span><br><span class="line">                <span class="comment">//如果开启了事务的手动提交，操作完毕后，归还给连接池之前，要将事务的自动提交改为true</span></span><br><span class="line">                connection.setAutoCommit(<span class="literal">true</span>);</span><br><span class="line">                <span class="comment">//将Connection对象归还给连接池</span></span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="十、DAO封装及BaseDAO工具类"><a href="#十、DAO封装及BaseDAO工具类" class="headerlink" title="十、DAO封装及BaseDAO工具类"></a>十、DAO封装及BaseDAO工具类</h3><h4 id="10-1-DAO概念"><a href="#10-1-DAO概念" class="headerlink" title="10.1 DAO概念"></a>10.1 DAO概念</h4><blockquote><p>DAO：Data Access Object，数据访问对象。</p><p>Java是面向对象语言，数据在Java中通常以对象的形式存在。一张表对应一个实体类，一张表的操作对应一个DAO对象！</p><p>在Java操作数据库时，我们会将对同一张表的增删改查操作统一维护起来，维护的这个类就是DAO层。</p><p>DAO层只关注对数据库的操作，供业务层Service调用，将职责划分清楚！</p></blockquote><h4 id="10-1-BaseDAO概念"><a href="#10-1-BaseDAO概念" class="headerlink" title="10.1 BaseDAO概念"></a>10.1 BaseDAO概念</h4><blockquote><p>基本上每一个数据表都应该有一个对应的DAO接口及其实现类，发现对所有表的操作（增、删、改、查）代码重复度很高，所以可以抽取公共代码，给这些DAO的实现类可以抽取一个公共的父类，复用增删改查的基本操作，我们称为BaseDAO。</p></blockquote><h4 id="10-2-BaseDAO搭建"><a href="#10-2-BaseDAO搭建" class="headerlink" title="10.2 BaseDAO搭建"></a>10.2 BaseDAO搭建</h4><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseDAO</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    通用的增、删、改的方法</span></span><br><span class="line"><span class="comment">    String sql：sql</span></span><br><span class="line"><span class="comment">    Object... args：给sql中的?设置的值列表，可以是0~n</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(String sql,Object... args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">//创建PreparedStatement对象，对sql预编译</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> JDBCTools.getConnection();</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//设置?占位符的值</span></span><br><span class="line">        <span class="keyword">if</span>(args != <span class="literal">null</span> &amp;&amp; args.length&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;args.length; i++) &#123;</span><br><span class="line">                ps.setObject(i+<span class="number">1</span>,args[i]);<span class="comment">//?的编号从1开始，不是从0开始，数组的下标是从0开始</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行sql</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">        ps.close();</span><br><span class="line">        <span class="comment">//这里检查下是否开启事务，开启不关闭连接，业务方法关闭!</span></span><br><span class="line">        <span class="comment">//connection.getAutoCommit()为false，不要在这里回收connection，由开启事务的地方回收</span></span><br><span class="line">        <span class="comment">//connection.getAutoCommit()为true，正常回收连接</span></span><br><span class="line">        <span class="comment">//没有开启事务的话，直接回收关闭即可!</span></span><br><span class="line">        <span class="keyword">if</span> (connection.getAutoCommit()) &#123;</span><br><span class="line">            <span class="comment">//回收</span></span><br><span class="line">            JDBCTools.release();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> len;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    通用的查询多个Javabean对象的方法，例如：多个员工对象，多个部门对象等</span></span><br><span class="line"><span class="comment">    这里的clazz接收的是T类型的Class对象，</span></span><br><span class="line"><span class="comment">    如果查询员工信息，clazz代表Employee.class，</span></span><br><span class="line"><span class="comment">    如果查询部门信息，clazz代表Department.class，</span></span><br><span class="line"><span class="comment">    返回List&lt;T&gt; list</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> &lt;T&gt; ArrayList&lt;T&gt; <span class="title function_">query</span><span class="params">(Class&lt;T&gt; clazz,String sql,Object... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//        创建PreparedStatement对象，对sql预编译</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> JDBCTools.getConnection();</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//设置?的值</span></span><br><span class="line">        <span class="keyword">if</span>(args != <span class="literal">null</span> &amp;&amp; args.length&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;args.length; i++) &#123;</span><br><span class="line">                ps.setObject(i+<span class="number">1</span>, args[i]);<span class="comment">//?的编号从1开始，不是从0开始，数组的下标是从0开始</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;T&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">res</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        获取结果集的元数据对象。</span></span><br><span class="line"><span class="comment">        元数据对象中有该结果集一共有几列、列名称是什么等信息</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="type">ResultSetMetaData</span> <span class="variable">metaData</span> <span class="operator">=</span> res.getMetaData();</span><br><span class="line">        <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> metaData.getColumnCount();<span class="comment">//获取结果集列数</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//遍历结果集ResultSet，把查询结果中的一条一条记录，变成一个一个T 对象，放到list中。</span></span><br><span class="line">        <span class="keyword">while</span>(res.next())&#123;</span><br><span class="line">            <span class="comment">//循环一次代表有一行，代表有一个T对象</span></span><br><span class="line">            <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> clazz.newInstance();<span class="comment">//要求这个类型必须有公共的无参构造</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//把这条记录的每一个单元格的值取出来，设置到t对象对应的属性中。</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=columnCount; i++)&#123;</span><br><span class="line">                <span class="comment">//for循环一次，代表取某一行的1个单元格的值</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> res.getObject(i);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//这个值应该是t对象的某个属性值</span></span><br><span class="line">                <span class="comment">//获取该属性对应的Field对象</span></span><br><span class="line">                <span class="comment">//String columnName = metaData.getColumnName(i);//获取第i列的字段名</span></span><br><span class="line">                <span class="comment">//这里再取别名可能没办法对应上</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> metaData.getColumnLabel(i);<span class="comment">//获取第i列的字段名或字段的别名</span></span><br><span class="line">                <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(columnName);</span><br><span class="line">                field.setAccessible(<span class="literal">true</span>);<span class="comment">//这么做可以操作private的属性</span></span><br><span class="line"></span><br><span class="line">                field.set(t,value);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            list.add(t);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res.close();</span><br><span class="line">        ps.close();</span><br><span class="line">        <span class="comment">//这里检查下是否开启事务，开启不关闭连接，业务方法关闭!</span></span><br><span class="line">        <span class="comment">//没有开启事务的话，直接回收关闭即可!</span></span><br><span class="line">        <span class="keyword">if</span> (connection.getAutoCommit()) &#123;</span><br><span class="line">            <span class="comment">//回收</span></span><br><span class="line">            JDBCTools.release();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> &lt;T&gt; T <span class="title function_">queryBean</span><span class="params">(Class&lt;T&gt; clazz,String sql, Object... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        ArrayList&lt;T&gt; list = query(clazz, sql,args);</span><br><span class="line">        <span class="keyword">if</span>(list &lt;mark&gt; <span class="literal">null</span> || list.size() &lt;/mark&gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h4 id="10-3-BaseDAO的应用"><a href="#10-3-BaseDAO的应用" class="headerlink" title="10.3 BaseDAO的应用"></a>10.3 BaseDAO的应用</h4><h5 id="10-3-1-创建员工DAO接口"><a href="#10-3-1-创建员工DAO接口" class="headerlink" title="10.3.1 创建员工DAO接口"></a>10.3.1 创建员工DAO接口</h5><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.senior.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.senior.pojo.Employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * EmployeeDao这个类对应的是t_emp这张表的增删改查的操作</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmployeeDao</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据库对应的查询所有的操作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 表中所有的数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;Employee&gt; <span class="title function_">selectAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据库对应的根据empId查询单个员工数据操作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> empId 主键列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 一个员工对象（一行数据）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Employee <span class="title function_">selectByEmpId</span><span class="params">(Integer empId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据库对应的新增一条员工数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee ORM思想中的一个员工对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 受影响的行数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insert</span><span class="params">(Employee employee)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据库对应的修改一条员工数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee ORM思想中的一个员工对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 受影响的行数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">update</span><span class="params">(Employee employee)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 数据库对应的根据empId删除一条员工数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> empId 主键列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 受影响的行数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">delete</span><span class="params">(Integer empId)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h5 id="10-3-2-创建员工DAO接口实现类"><a href="#10-3-2-创建员工DAO接口实现类" class="headerlink" title="10.3.2 创建员工DAO接口实现类"></a>10.3.2 创建员工DAO接口实现类</h5><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.senior.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.senior.dao.BaseDAO;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.senior.dao.EmployeeDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.senior.pojo.Employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDAO</span> <span class="keyword">implements</span> <span class="title class_">EmployeeDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">selectAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT emp_id empId,emp_name empName,emp_salary empSalary,emp_age empAge FROM t_emp&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> executeQuery(Employee.class,sql,<span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Employee <span class="title function_">selectByEmpId</span><span class="params">(Integer empId)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT emp_id empId,emp_name empName,emp_salary empSalary,emp_age empAge FROM t_emp where emp_id = ?&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> executeQueryBean(Employee.class,sql,empId);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insert</span><span class="params">(Employee employee)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO t_emp(emp_name,emp_salary,emp_age) VALUES (?,?,?)&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> executeUpdate(sql,employee.getEmpName(),employee.getEmpSalary(),employee.getEmpAge());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(Employee employee)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;UPDATE t_emp SET emp_salary = ? WHERE emp_id = ?&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> executeUpdate(sql,employee.getEmpSalary(),employee.getEmpId());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">delete</span><span class="params">(Integer empId)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from t_emp where emp_id = ?&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> executeUpdate(sql,empId);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h3 id="十一、事务-SQL基本命令-mk-20240915000941-link"><a href="#十一、事务-SQL基本命令-mk-20240915000941-link" class="headerlink" title="十一、事务 [[SQL基本命令#^mk-20240915000941|link]]"></a>十一、事务 [[SQL基本命令#^mk-20240915000941|link]]</h3><h4 id="11-1-事务回顾"><a href="#11-1-事务回顾" class="headerlink" title="11.1 事务回顾"></a>11.1 事务回顾</h4><ul><li>数据库事务就是一种SQL语句执行的缓存机制，不会单条执行完毕就更新数据库数据，最终根据缓存内的多条语句执行结果统一判定! 一个事务内所有语句都成功及事务成功，我们可以触发commit提交事务来结束事务，更新数据! 一个事务内任意一条语句失败，即为事务失败，我们可以触发rollback回滚结束事务，数据回到事务之前状态!</li><li>一个业务涉及多条修改数据库语句! 例如:<ul><li>经典的转账案例，转账业务(A账户减钱和B账户加钱，要一起成功)</li><li>批量删除(涉及多个删除)</li><li>批量添加(涉及多个插入)</li></ul></li><li>事务的特性：<ol><li>原子性（Atomicity）原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生， 要么都不发生。</li><li>一致性（Consistency）事务必须使数据库从一个一致性状态变换到另外一个一致性状态。</li><li>隔离性（Isolation）事务的隔离性是指一个事务的执行不能被其他事务干扰， 即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。</li><li>持久性（Durability）持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的， 接下来的其他操作和数据库故障不应该对其有任何影响</li></ol></li><li>事务的提交方式：<ul><li>自动提交：每条语句自动存储一个事务中，执行成功自动提交，执行失败自动回滚!</li><li>手动提交: 手动开启事务，添加语句，手动提交或者手动回滚即可!</li></ul></li></ul><h4 id="11-2-JDBC中事务实现"><a href="#11-2-JDBC中事务实现" class="headerlink" title="11.2 JDBC中事务实现"></a>11.2 JDBC中事务实现</h4><ul><li><p>关键代码：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    connection.setAutoCommit(<span class="literal">false</span>); <span class="comment">//关闭自动提交了</span></span><br><span class="line">    <span class="comment">//connection.setAutoCommit(false)也就类型于SET autocommit = off</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//注意，只要当前connection对象，进行数据库操作，都不会自动提交事务</span></span><br><span class="line">    <span class="comment">//数据库动作!</span></span><br><span class="line">    <span class="comment">//prepareStatement - 单一的数据库动作 c r u d </span></span><br><span class="line">    <span class="comment">//connection - 操作事务 </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//所有操作执行正确，提交事务！</span></span><br><span class="line">    connection.commit();</span><br><span class="line">  &#125;<span class="keyword">catch</span>(Execption e)&#123;</span><br><span class="line">    <span class="comment">//出现异常，则回滚事务！</span></span><br><span class="line">    connection.rollback();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div></li></ul><h4 id="11-3-JDBC事务代码实现"><a href="#11-3-JDBC事务代码实现" class="headerlink" title="11.3  JDBC事务代码实现"></a>11.3 JDBC事务代码实现</h4><ul><li><p>准备数据库表：</p><div class="code-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 继续在atguigu的库中创建银行表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> t_bank(</span><br><span class="line">   id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;账号主键&#x27;</span>,</span><br><span class="line">   account <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span> <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;账号&#x27;</span>,</span><br><span class="line">   money  <span class="type">INT</span> UNSIGNED COMMENT <span class="string">&#x27;金额，不能为负值&#x27;</span>) ;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">INSERT INTO</span> t_bank(account,money) <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="string">&#x27;zhangsan&#x27;</span>,<span class="number">1000</span>),(<span class="string">&#x27;lisi&#x27;</span>,<span class="number">1000</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div></li><li><p>DAO接口代码：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BankDao</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">addMoney</span><span class="params">(Integer id,Integer money)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">subMoney</span><span class="params">(Integer id,Integer money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>DAO实现类代码：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankDaoImpl</span>  <span class="keyword">extends</span> <span class="title class_">BaseDao</span> <span class="keyword">implements</span> <span class="title class_">BankDao</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addMoney</span><span class="params">(Integer id,Integer money)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update t_bank set money = money + ? where id = ? &quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> executeUpdate(sql,money,id);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">subMoney</span><span class="params">(Integer id,Integer money)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update t_bank set money = money - ? where id = ? &quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> executeUpdate(sql,money,id);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>测试代码：</p><div class="code-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTransaction</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="type">BankDao</span> <span class="variable">bankDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BankDaoImpl</span>();</span><br><span class="line">       Connection connection=<span class="literal">null</span>;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="comment">//1.获取连接，将连接的事务提交改为手动提交</span></span><br><span class="line">           connection = JDBCUtilV2.getConnection();</span><br><span class="line">           connection.setAutoCommit(<span class="literal">false</span>);<span class="comment">//开启事务，当前连接的自动提交关闭。改为手动提交！</span></span><br><span class="line"> </span><br><span class="line">           <span class="comment">//2.操作减钱</span></span><br><span class="line">           bankDao.subMoney(<span class="number">1</span>,<span class="number">100</span>);</span><br><span class="line"> </span><br><span class="line">           <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">10</span> / <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">           <span class="comment">//3.操作加钱</span></span><br><span class="line">           bankDao.addMoney(<span class="number">2</span>,<span class="number">100</span>);</span><br><span class="line"> </span><br><span class="line">           <span class="comment">//4.前置的多次dao操作，没有异常，提交事务！</span></span><br><span class="line">           connection.commit();</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               connection.rollback();</span><br><span class="line">           &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(ex);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">           JDBCUtilV2.release();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div></li></ul><p><strong>注意：</strong></p><blockquote><p>当开启事务后，切记一定要根据代码执行结果来决定是否提交或回滚！否则数据库看不到数据的操作结果！</p></blockquote></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>Title:</strong> JDBC</li><li><strong>Author:</strong> Lu</li><li><strong>Created at :</strong> 2024-05-21 00:00:00</li><li><strong>Updated at :</strong> 2025-03-11 12:44:58</li><li><strong>Link:</strong> https://lusy.ink/2024/05/21/JDBC/</li><li><strong>License: </strong>This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.</li></ul></div></div><ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden"><li class="tag-item mx-0.5"><a href="/tags/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/">#学习总结</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/Java/">#Java</a>&nbsp;</li></ul><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2024/05/30/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item">Java 多线程</span> <span class="post-nav-item">Prev posts</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2024/05/06/Stream%E6%B5%81/"><span class="title flex justify-center items-center"><span class="post-nav-title-item">Stream流</span> <span class="post-nav-item">Next posts</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div><div class="comment-container px-2 sm:px-6 md:px-8 pb-8"><div class="comments-container mt-10 w-full"><div id="comment-anchor" class="w-full h-2.5"></div><div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">Comments</div><div id="waline"></div><script type="module" data-swup-reload-script>import{init}from"/js/libs/waline.mjs";function loadWaline(){init({el:"#waline",serverURL:"https://comment.lusy.ink",lang:"zh-CN",dark:'body[class~="dark-mode"]',reaction:!1,requiredMeta:["nick","mail"],emoji:[]})}"undefined"!=typeof swup?loadWaline():window.addEventListener("DOMContentLoaded",loadWaline)</script></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">On this page</div><div class="page-title">JDBC</div><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#8-x%E6%95%B0%E6%8D%AE%E5%BA%93-JDK21%E7%89%88JDBC%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%8A%80%E6%9C%AF"><span class="nav-text">8.x数据库+JDK21版JDBC数据库连接技术</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%AF%87"><span class="nav-text">基础篇</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80"><span class="nav-text">一、引言</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AD%98%E5%82%A8"><span class="nav-text">1.1 数据的存储</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-text">1.2 数据的操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81JDBC"><span class="nav-text">二、JDBC</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-JDBC%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-text">2.1 JDBC的概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-JDBC%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E6%88%90"><span class="nav-text">2.2 JDBC的核心组成</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81JDBC%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="nav-text">三、JDBC快速入门</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-JDBC%E6%90%AD%E5%BB%BA%E6%AD%A5%E9%AA%A4"><span class="nav-text">3.1 JDBC搭建步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">3.2 代码实现</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-1-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">3.2.1 数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-2-Java%E4%BB%A3%E7%A0%81"><span class="nav-text">3.2.2 Java代码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-%E6%AD%A5%E9%AA%A4%E6%80%BB%E7%BB%93"><span class="nav-text">3.3 步骤总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E6%A0%B8%E5%BF%83API%E7%90%86%E8%A7%A3"><span class="nav-text">四、核心API理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-%E6%B3%A8%E5%86%8C%E9%A9%B1%E5%8A%A8"><span class="nav-text">4.1 注册驱动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-Connection"><span class="nav-text">4.2 Connection</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-Statement"><span class="nav-text">4.3 Statement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-PreparedStatement"><span class="nav-text">4.4 PreparedStatement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5-ResultSet"><span class="nav-text">4.5 ResultSet</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%9F%BA%E4%BA%8EPreparedStatement%E5%AE%9E%E7%8E%B0CRUD"><span class="nav-text">五、基于PreparedStatement实现CRUD</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-%E6%9F%A5%E8%AF%A2%E5%8D%95%E8%A1%8C%E5%8D%95%E5%88%97"><span class="nav-text">5.1 查询单行单列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-%E6%9F%A5%E8%AF%A2%E5%8D%95%E8%A1%8C%E5%A4%9A%E5%88%97"><span class="nav-text">5.2 查询单行多列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-%E6%9F%A5%E8%AF%A2%E5%A4%9A%E8%A1%8C%E5%A4%9A%E5%88%97"><span class="nav-text">5.3 查询多行多列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-%E6%96%B0%E5%A2%9E"><span class="nav-text">5.4 新增</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-5-%E4%BF%AE%E6%94%B9"><span class="nav-text">5.5 修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-6-%E5%88%A0%E9%99%A4"><span class="nav-text">5.6 删除</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="nav-text">六、常见问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-%E8%B5%84%E6%BA%90%E7%9A%84%E7%AE%A1%E7%90%86"><span class="nav-text">6.1 资源的管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-SQL%E8%AF%AD%E5%8F%A5%E9%97%AE%E9%A2%98"><span class="nav-text">6.2 SQL语句问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-SQL%E8%AF%AD%E5%8F%A5%E6%9C%AA%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%E9%97%AE%E9%A2%98"><span class="nav-text">6.3 SQL语句未设置参数问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-4-%E7%94%A8%E6%88%B7%E5%90%8D%E6%88%96%E5%AF%86%E7%A0%81%E9%94%99%E8%AF%AF%E9%97%AE%E9%A2%98"><span class="nav-text">6.4 用户名或密码错误问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-5-%E9%80%9A%E4%BF%A1%E5%BC%82%E5%B8%B8"><span class="nav-text">6.5 通信异常</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E9%98%B6%E7%AF%87"><span class="nav-text">进阶篇</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E3%80%81JDBC%E6%89%A9%E5%B1%95"><span class="nav-text">七、JDBC扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%92%8CORM"><span class="nav-text">7.1 实体类和ORM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-%E4%B8%BB%E9%94%AE%E5%9B%9E%E6%98%BE"><span class="nav-text">7.2 主键回显</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-3-%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C"><span class="nav-text">7.3 批量操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-text">八、连接池</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#8-1-%E7%8E%B0%E6%9C%89%E9%97%AE%E9%A2%98"><span class="nav-text">8.1 现有问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-text">8.2 连接池</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-3-%E5%B8%B8%E8%A7%81%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-text">8.3 常见连接池</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-4-Druid%E8%BF%9E%E6%8E%A5%E6%B1%A0%E4%BD%BF%E7%94%A8"><span class="nav-text">8.4 Druid连接池使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-5-Druid%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E3%80%90%E4%BA%86%E8%A7%A3%E3%80%91"><span class="nav-text">8.5 Druid其他配置【了解】</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-6-HikariCP%E8%BF%9E%E6%8E%A5%E6%B1%A0%E4%BD%BF%E7%94%A8"><span class="nav-text">8.6 HikariCP连接池使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-7-HikariCP%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE%E3%80%90%E4%BA%86%E8%A7%A3%E3%80%91"><span class="nav-text">8.7 HikariCP其他配置【了解】</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E7%AF%87"><span class="nav-text">高级篇</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%9D%E3%80%81JDBC%E4%BC%98%E5%8C%96%E5%8F%8A%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%B0%81%E8%A3%85"><span class="nav-text">九、JDBC优化及工具类封装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-%E7%8E%B0%E6%9C%89%E9%97%AE%E9%A2%98"><span class="nav-text">9.1 现有问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-JDBC%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%B0%81%E8%A3%85V1-0"><span class="nav-text">9.2 JDBC工具类封装V1.0</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-3-ThreadLocal"><span class="nav-text">9.3 ThreadLocal</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-4-JDBC%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%B0%81%E8%A3%85V2-0"><span class="nav-text">9.4 JDBC工具类封装V2.0</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%81%E3%80%81DAO%E5%B0%81%E8%A3%85%E5%8F%8ABaseDAO%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="nav-text">十、DAO封装及BaseDAO工具类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#10-1-DAO%E6%A6%82%E5%BF%B5"><span class="nav-text">10.1 DAO概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-1-BaseDAO%E6%A6%82%E5%BF%B5"><span class="nav-text">10.1 BaseDAO概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-2-BaseDAO%E6%90%AD%E5%BB%BA"><span class="nav-text">10.2 BaseDAO搭建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-3-BaseDAO%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-text">10.3 BaseDAO的应用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#10-3-1-%E5%88%9B%E5%BB%BA%E5%91%98%E5%B7%A5DAO%E6%8E%A5%E5%8F%A3"><span class="nav-text">10.3.1 创建员工DAO接口</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-3-2-%E5%88%9B%E5%BB%BA%E5%91%98%E5%B7%A5DAO%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-text">10.3.2 创建员工DAO接口实现类</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1-SQL%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4-mk-20240915000941-link"><span class="nav-text">十一、事务 [[SQL基本命令#^mk-20240915000941|link]]</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#11-1-%E4%BA%8B%E5%8A%A1%E5%9B%9E%E9%A1%BE"><span class="nav-text">11.1 事务回顾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-2-JDBC%E4%B8%AD%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0"><span class="nav-text">11.2 JDBC中事务实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-3-JDBC%E4%BA%8B%E5%8A%A1%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">11.3 JDBC事务代码实现</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="text-center">&copy; <span>2024</span> - 2025&nbsp;&nbsp;<i class="fa-regular fa-computer-classic"></i>&nbsp;&nbsp;<a href="/">Lu</a><p class="post-count space-x-0.5"><span>23 posts in total </span><span>160.9k words in total</span></p></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">VISITOR COUNT</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">TOTAL PAGE VIEWS</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span> <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span></div><div>Blog up for <span class="odometer" id="runtime_days"></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li><li class="go-comment"><i class="fa-regular fa-comments"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fa-solid fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa-solid fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Swup.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupSlideTheme.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScriptsPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupProgressPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScrollPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/imageViewer.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/utils.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/main.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/navbarShrink.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/scrollTopBottom.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/lightDarkSwitch.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/categoryList.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/localSearch.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/codeBlock.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/lazyload.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/runtime.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/odometer.min.js"></script><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/assets/odometer-theme-minimal.css"><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Typed.min.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/typed.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/tocToggle.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/toc.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/tabs.js" data-swup-reload-script></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/moment-with-locales.min.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/essays.js" data-swup-reload-script></script></body></html>